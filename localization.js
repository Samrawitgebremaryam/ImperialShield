const translations = {
    en: {
        // Index page
        mainTitle: "Battle of Dabarki",
        subtitle: "A Historic Defense of Ethiopian Legacy",
        sections: {
            battle: {
                title: "The Battle",
                description: "Step into the historic Battle of Dabarki, where Emperor Tewodros II faces the advancing English forces! Your courage will shape Ethiopia's destiny."
            },
            mission: {
                title: "Your Mission",
                description: "Command the Ethiopian defenders and protect your emperor from the invading British army. Every shot counts in this crucial moment of Ethiopian history."
            },
            victory: {
                title: "Victory",
                description: "Show your tactical prowess and defend the honor of Ethiopia! Lead your forces to triumph and secure your place in history."
            }
        },
        controls: {
            attack: "⚔️ Attack",
            attackKey: "Press SPACE to fire",
            moveLeft: "⬅️ Move Left",
            moveLeftKey: "LEFT ARROW key",
            moveRight: "➡️ Move Right",
            moveRightKey: "RIGHT ARROW key"
        },
        buttons: {
            instructions: "Instructions",
            defend: "Defend Ethiopia",
            playAgain: "Play Again"
        },
        conditions: {
            title: "Battle Conditions",
            backButton: "← Back",
            instructions: {
                title: "Instructions",
                rule1: "Defend Emperor Tewodros II from the advancing forces",
                rule2: "Use arrow keys to move left and right",
                rule3: "Press SPACE to fire at enemies",
                rule4: "Defeat all enemies to advance to the next wave",
                rule5: "Don't let the enemies reach your position"
            }
        },
        game: {
            score: "Score",
            wave: "Wave",
            gameOver: "Game Over",
            victory: "Victory!",
            playAgain: "Play Again",
            battleConditions: "Battle Conditions",
            roadToVictory: "Road to Victory",
            conditions: {
                eliminate: "Eliminate all waves of invaders",
                protect: "Protect Emperor Tewodros II",
                advance: "Advance through enemy lines"
            },
            defeatConditions: "DEFEAT CONDITIONS",
            battleRewards: "BATTLE REWARDS",
            defeatRules: {
                rule1: "Enemy reaches your position",
                rule2: "Emperor's health reaches zero",
                rule3: "All defenders are lost"
            },
            rewards: {
                rule1: "Victory points for each enemy defeated",
                rule2: "Bonus points for perfect defense",
                rule3: "Historical achievement unlocked"
            },
            victoryMessage: {
                title: "Victory for Ethiopia!",
                subtitle: "Your bravery has protected Emperor Tewodros II and defended our homeland!",
                footer: "Your name will be remembered in Ethiopian history."
            }
        }
    },
    am: {
        // Index page
        mainTitle: "የዳባርኪ ጦርነት",
        subtitle: "የኢትዮጵያ ታሪካዊ መከላከያ",
        sections: {
            battle: {
                title: "ጦርነቱ",
                description: "በታሪካዊው የዳባርኪ ጦርነት ውስጥ፣ አጼ ቴዎድሮስ ሁለተኛ ከሚመጡት የእንግሊዝ ኃይሎች ጋር ይጋፈጣሉ! ድፍረትዎ የኢትዮጵያን እጣ ፈንታ ይወስናል።"
            },
            mission: {
                title: "ተልእኮዎ",
                description: "የኢትዮጵያን ተגኞች በመምራት ንጉሳችንን ከወራሪው የእንግሊዝ ሰራዊት ይጠብቁ። በዚህ ወሳኝ የኢትዮጵያ ታሪክ ላይ እያንዳንዱ ተኩስ ጠቃሚ ነው።"
            },
            victory: {
                title: "ድል",
                description: "የጦር ስልትዎን አሳይተው የኢትዮጵያን ክብር ይጠብቁ! ኃይሎችዎን ወደ ድል በመምራት በታሪክ ውስጥ ስፍራዎን ያረጋግጡ።"
            }
        },
        controls: {
            attack: "⚔️ ተኩስ",
            attackKey: "ለመተኮስ SPACE ይጫኑ",
            moveLeft: "⬅️ ወደ ግራ",
            moveLeftKey: "የግራ ቀስት ቁልፍ",
            moveRight: "➡️ ወደ ቀኝ",
            moveRightKey: "የቀኝ ቀስት ቁልፍ"
        },
        buttons: {
            instructions: "መመሪያዎች",
            defend: "ኢትዮጵያን ከላክ",
            playAgain: "እንደገና ጨዋታ"
        },
        conditions: {
            title: "የጦርነት ሁኔታዎች",
            backButton: "← ተመለስ",
            instructions: {
                title: "መመሪያዎች",
                rule1: "አጼ ቴዎድሮስን ከሚመጡት ጠላቶች ጠብቅ",
                rule2: "ወደ ግራና ቀኝ ለመንቀሳቀስ የቀስት ቁልፎችን ተጠቀም",
                rule3: "ለመተኮስ SPACE ቁልፍን ተጠቀም",
                rule4: "ወደ ቀጣይ ደረጃ ለማለፍ ጠላቶችን ሁሉ አሸንፍ",
                rule5: "ጠላቶች ወደ አንተ እንዲደርሱ አትፍቀድ"
            }
        },
        game: {
            score: "ውጤት",
            wave: "ሞገድ",
            gameOver: "ጨዋታው አልቋል",
            victory: "ድል!",
            playAgain: "እንደገና ጨዋታ",
            battleConditions: "የጦርነት ሁኔታዎች",
            roadToVictory: "ወደ ድል የሚወስደው መንገድ",
            conditions: {
                eliminate: "ሁሉንም የጠላት ሞገዶች ማጥፋት",
                protect: "አጼ ቴዎድሮስን መጠበቅ",
                advance: "በጠላት መስመሮች ውስጥ መራመድ"
            },
            defeatConditions: "የражት ሁኔታዎች",
            battleRewards: "የጦርነት ሽልማቶች",
            defeatRules: {
                rule1: "ጠላት ወደ እርስዎ ቦታ ሲደርስ",
                rule2: "የንጉሱ ጤንነት ወደ ዜሮ ሲደርስ",
                rule3: "ሁሉም ተגኞች ሲጠፉ"
            },
            rewards: {
                rule1: "ለእያንዳንዱ የተገደለ ጠላት የድል ነጥቦች",
                rule2: "ለፍጹም መከላከል ተጨማሪ ነጥቦች",
                rule3: "የታሪክ ውጤት ተከፍቷል"
            },
            victoryMessage: {
                title: "ለኢትዮጵያ ድል!",
                subtitle: "ድፍረትዎ አጼ ቴዎድሮስን እና አገራችንን ጠብቋል!",
                footer: "ስምዎ በኢትዮጵያ ታሪክ ውስጥ ይዘከራል።"
            }
        }
    }
};

// Initialize language handling
let currentLang = localStorage.getItem('gameLang') || 'am';

function setLanguage(lang) {
    currentLang = lang;
    localStorage.setItem('gameLang', lang);
    updateUI();
    updateActiveButton();
    
    // Update page title
    document.title = getText('mainTitle');
}

function getText(key) {
    try {
        const keys = key.split('.');
        let value = translations[currentLang];
        for (const k of keys) {
            value = value[k];
        }
        return value || key;
    } catch (error) {
        console.warn(`Translation key not found: ${key}`);
        return key;
    }
}

function updateUI() {
    document.querySelectorAll('[data-translate]').forEach(element => {
        const key = element.getAttribute('data-translate');
        element.textContent = getText(key);
    });
}

function updateActiveButton() {
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.getAttribute('data-lang') === currentLang) {
            btn.classList.add('active');
        }
    });
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', () => {
    // Set initial language from localStorage
    const savedLang = localStorage.getItem('gameLang');
    if (savedLang) {
        setLanguage(savedLang);
    } else {
        setLanguage('am'); // Default to Amharic
    }
});
